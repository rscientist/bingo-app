<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bingo 0-999</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #grid { display: grid; grid-template-columns: repeat(20, 50px); gap: 5px; margin-bottom: 20px; }
  .number { padding: 10px; border: 1px solid #ccc; text-align: center; cursor: pointer; }
  .reserved { background-color: #f88; cursor: not-allowed; }
  .available { background-color: #8f8; }
  #admin-panel { border: 1px solid #ccc; padding: 10px; max-width: 400px; }
  #admin-panel input { margin: 5px 0; width: 100%; padding: 5px; }
</style>
</head>
<body>

<h1>Bingo 0-999</h1>
<div id="grid"></div>

<h2>Admin Panel</h2>
<div id="admin-panel">
  <input type="number" id="block-number" placeholder="Number to block" min="0" max="999"/>
  <input type="text" id="block-note" placeholder="Note (e.g., cash payment)"/>
  <button id="block-btn">Block Number</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const grid = document.getElementById('grid');
const socket = io();

function renderGrid(numbers) {
  grid.innerHTML = '';
  numbers.forEach(n => {
    const div = document.createElement('div');
    div.className = 'number ' + (n.status === 'reserved' ? 'reserved' : 'available');
    div.textContent = n.number;
    grid.appendChild(div);
  });
}

// Load numbers from backend
async function loadNumbers() {
  const res = await fetch('/api/numbers');
  const data = await res.json();
  renderGrid(data);
}
loadNumbers();

// Listen for real-time updates
socket.on('numbers:update', (updates) => {
  loadNumbers(); // simple re-render on update
});

// Admin panel block
document.getElementById('block-btn').addEventListener('click', async () => {
  const number = parseInt(document.getElementById('block-number').value);
  const note = document.getElementById('block-note').value;
  if (isNaN(number) || number < 0 || number > 999) return alert('Enter a valid number 0-999');

  const res = await fetch('/api/admin/block', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ number, note })
  });
  if(res.ok){
    alert('Number blocked successfully!');
    document.getElementById('block-number').value = '';
    document.getElementById('block-note').value = '';
    loadNumbers();
  } else {
    alert('Error blocking number');
  }
});
</script>
</body>
</html>
